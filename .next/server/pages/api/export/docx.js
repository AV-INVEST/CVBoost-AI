"use strict";(()=>{var e={};e.id=814,e.ids=[814],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3808:e=>{e.exports=import("docx")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,a){return a in t?t[a]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,a)):"function"==typeof t&&"default"===a?t:void 0}}})},1382:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{config:()=>P,default:()=>d,routeModule:()=>s});var n=a(1802),o=a(7153),i=a(6249),p=a(8042),c=e([p]);p=(c.then?(await c)():c)[0];let d=(0,i.l)(p,"default"),P=(0,i.l)(p,"config"),s=new n.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/export/docx",pathname:"/api/export/docx",bundlePath:"",filename:""},userland:p});r()}catch(e){r(e)}})},8042:(e,t,a)=>{a.a(e,async(e,r)=>{try{a.r(t),a.d(t,{default:()=>i});var n=a(3808),o=e([n]);async function i(e,t){if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});try{let{score:a,missingKeywords:r,suggestions:o,improvedResume:i,coverLetter:p}=e.body,c=new n.Document({sections:[{children:[new n.Paragraph({text:"CVBoost.ai â€” Report ATS",heading:n.HeadingLevel.TITLE}),new n.Paragraph({text:`Punteggio Match: ${a}/100`}),new n.Paragraph({text:" "}),new n.Paragraph({text:"Keyword mancanti:"}),...r.map(e=>new n.Paragraph({text:"- "+e})),new n.Paragraph({text:" "}),new n.Paragraph({text:"Suggerimenti:"}),...o.map(e=>new n.Paragraph({text:"- "+e})),new n.Paragraph({text:" "}),new n.Paragraph({text:"CV Riscritto:"}),new n.Paragraph({text:i}),new n.Paragraph({text:" "}),new n.Paragraph({text:"Cover Letter:"}),new n.Paragraph({text:p})]}]}),d=await n.Packer.toBuffer(c);t.setHeader("Content-Type","application/vnd.openxmlformats-officedocument.wordprocessingml.document"),t.setHeader("Content-Disposition","attachment; filename=cvboost-report.docx"),t.send(d)}catch(e){console.error("DOCX export error:",e),t.status(500).json({error:"Failed to generate DOCX"})}}n=(o.then?(await o)():o)[0],r()}catch(e){r(e)}})},7153:(e,t)=>{var a;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return a}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(a||(a={}))},1802:(e,t,a)=>{e.exports=a(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var a=t(t.s=1382);module.exports=a})();